# 41.TreeMap的使用和底层实现


1. TreeMap的常用构造方法有哪些？ 
  1. 无参构造方法TreeMap();
  1. TreeMap(Comparator<>)；传入外部比较器的构造方法
  1. TreeMap(Map<>);没学
  1. TreeMap(SortedMap<>);没学
2. TreeMap的底层数据结构是什么？
  1. 红黑树

![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985046704-fdfa5fe1-3a17-4721-848f-5774d7ed56db.png#align=left&display=inline&height=127&name=image.png&originHeight=254&originWidth=683&size=80354&status=done&width=341.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985074868-8bc0dae9-0eb4-4f5e-9b15-66b7aeb3f949.png#align=left&display=inline&height=396&name=image.png&originHeight=792&originWidth=1519&size=644590&status=done&width=759.5)<br />导入<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985085048-bc1c1a79-9b90-4f3a-8b02-08575fc2b0bf.png#align=left&display=inline&height=25&name=image.png&originHeight=49&originWidth=436&size=21588&status=done&width=218)<br />new<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985107853-c72573e9-efa6-4020-9c4c-159742496e99.png#align=left&display=inline&height=40&name=image.png&originHeight=79&originWidth=509&size=46550&status=done&width=254.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985174877-92a6c381-853b-462f-aba7-00ac4ec4446c.png#align=left&display=inline&height=18&name=image.png&originHeight=36&originWidth=101&size=6845&status=done&width=50.5)集合中元素的个数<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985162558-f3ab6d86-fcca-42eb-8c93-4e6052134f43.png#align=left&display=inline&height=15&name=image.png&originHeight=30&originWidth=178&size=9603&status=done&width=89)给定一个集合的键看键是否存在<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985198179-3ca8c995-2557-49e1-948e-abecf4494b8e.png#align=left&display=inline&height=15&name=image.png&originHeight=30&originWidth=201&size=10793&status=done&width=100.5)看值是否存在<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985217560-eecdc6ef-2e6b-47a7-9902-8cc80fe08219.png#align=left&display=inline&height=15&name=image.png&originHeight=30&originWidth=165&size=8203&status=done&width=82.5)根据键获取<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985228533-771b1e3f-adcb-4306-be23-6ae019ad605e.png#align=left&display=inline&height=33&name=image.png&originHeight=65&originWidth=185&size=22481&status=done&width=92.5)添加移除<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985238067-de40c817-3073-4eb7-8fc0-abbd2abef133.png#align=left&display=inline&height=20&name=image.png&originHeight=39&originWidth=151&size=9590&status=done&width=75.5)清除<br />和map接口方法都相同<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985257803-d280a165-8df2-4be7-8e58-952603725788.png#align=left&display=inline&height=22&name=image.png&originHeight=43&originWidth=173&size=12920&status=done&width=86.5)获取所有键的集合<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985269199-250b4173-2988-4880-88da-114412730eee.png#align=left&display=inline&height=17&name=image.png&originHeight=33&originWidth=224&size=11834&status=done&width=112)获取所有值的集合<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985282762-f1d21a1e-8a77-4cc6-9274-6094c24f7594.png#align=left&display=inline&height=20&name=image.png&originHeight=39&originWidth=261&size=17393&status=done&width=130.5)获取所有键值关系的集合

使用<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985329976-811fac44-1074-427b-a723-a657736c7a74.png#align=left&display=inline&height=33&name=image.png&originHeight=65&originWidth=446&size=39657&status=done&width=223)自动装箱<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985375063-cef0e48b-8fa7-4c2a-93f1-18029dd4d66e.png#align=left&display=inline&height=156&name=image.png&originHeight=312&originWidth=696&size=245533&status=done&width=348)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985428858-0c8b8f93-8c73-498f-bf1b-6f73fd0f4eb9.png#align=left&display=inline&height=36&name=image.png&originHeight=71&originWidth=780&size=76047&status=done&width=390)<br />进行了值的覆盖<br />并且是按照键的升序排列<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985470589-808f26ac-898f-438a-b56f-8b229624807b.png#align=left&display=inline&height=21&name=image.png&originHeight=42&originWidth=725&size=51232&status=done&width=362.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985482644-4904b71a-00af-4eb7-894a-6e992717e9fe.png#align=left&display=inline&height=18&name=image.png&originHeight=35&originWidth=683&size=47605&status=done&width=341.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985494973-77cf3d14-4b84-4ef8-935e-ee99d14309cf.png#align=left&display=inline&height=23&name=image.png&originHeight=45&originWidth=619&size=46371&status=done&width=309.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985533332-36ba84f6-5e94-4739-95e1-8567e9c0e02f.png#align=left&display=inline&height=69&name=image.png&originHeight=138&originWidth=376&size=48822&status=done&width=188)

![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985510389-a13c6a33-2bd0-450c-a5da-e99e7014a42f.png#align=left&display=inline&height=17&name=image.png&originHeight=33&originWidth=253&size=13072&status=done&width=126.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985553968-ef3b5877-7d76-4871-9513-80821ab69187.png#align=left&display=inline&height=51&name=image.png&originHeight=102&originWidth=405&size=36638&status=done&width=202.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985568443-4403ff72-1c60-4163-91e0-b88511573b78.png#align=left&display=inline&height=18&name=image.png&originHeight=35&originWidth=776&size=43489&status=done&width=388)<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985625104-2975166c-8e67-4f26-a990-b7da1a02b3ef.png#align=left&display=inline&height=22&originHeight=43&originWidth=1030&status=done&width=515)<br />一个接口，外部比较器，里面的键是升序的，必须进行比较

添加元素

put<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985743637-1e8a7697-3ded-4134-8a40-c5e242b93a97.png#align=left&display=inline&height=33&name=image.png&originHeight=66&originWidth=628&size=38691&status=done&width=314)<br />给个键给个值，然后看root是啥<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985791976-68885991-9010-4005-af8a-903c2b06f4ce.png#align=left&display=inline&height=16&name=image.png&originHeight=31&originWidth=745&size=40006&status=done&width=372.5)<br />刚创造完集合一个元素都没有的，树根为空<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985919959-dd0168dc-6c97-418a-b40d-92a5eaf6efe2.png#align=left&display=inline&height=18&name=image.png&originHeight=36&originWidth=483&size=27667&status=done&width=241.5)<br />这个t指向我们的树根，而这个树根现在为空<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559985998395-be832f53-1318-434b-b064-9567075ba776.png#align=left&display=inline&height=159&name=image.png&originHeight=318&originWidth=879&size=138838&status=done&width=439.5)

![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986016584-2b3da13b-c0b9-4062-a275-ffd9bdee6468.png#align=left&display=inline&height=49&name=image.png&originHeight=98&originWidth=639&size=58436&status=done&width=319.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986102399-311f488f-ab6c-4a8f-8261-a659ef17ece6.png#align=left&display=inline&height=39&name=image.png&originHeight=77&originWidth=764&size=62596&status=done&width=382)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986116718-1c15a598-61de-4c5d-a926-a72357511b1f.png#align=left&display=inline&height=55&name=image.png&originHeight=110&originWidth=700&size=47356&status=done&width=350)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986140845-0464b0ef-7896-4ad5-b020-5eb90f642854.png#align=left&display=inline&height=21&name=image.png&originHeight=42&originWidth=1132&size=72288&status=done&width=566)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986179831-2ba92ecb-adda-4e39-b72d-b985f1a05eed.png#align=left&display=inline&height=212&name=image.png&originHeight=423&originWidth=950&size=209690&status=done&width=475)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986196671-dfe2ad49-3e09-4070-b049-e960d2021088.png#align=left&display=inline&height=21&name=image.png&originHeight=42&originWidth=627&size=36428&status=done&width=313.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986226991-0db085df-4380-4b0a-b5cc-eeb99e071416.png#align=left&display=inline&height=47&name=image.png&originHeight=93&originWidth=645&size=64564&status=done&width=322.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986233256-7c7c8815-e049-4b42-9109-b1bbec727491.png#align=left&display=inline&height=21&name=image.png&originHeight=42&originWidth=927&size=45769&status=done&width=463.5)<br />把key赋值给了内部比较器<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986369862-dcdb7bc2-1eed-4276-888e-c6df9d933fc4.png#align=left&display=inline&height=160&name=image.png&originHeight=319&originWidth=1081&size=216540&status=done&width=540.5)<br />如果左右子树都找到了，没找到，那就创建一个节点<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986440456-f45df7e1-96f5-4d07-92a1-c57c3428d687.png#align=left&display=inline&height=181&name=image.png&originHeight=361&originWidth=802&size=160994&status=done&width=401)<br />添加后集合的个数++

什么是内部比较器，什么是外部比较器<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986562370-7c797a53-1751-48c2-beb3-e503828db2b0.png#align=left&display=inline&height=106&name=image.png&originHeight=211&originWidth=401&size=90335&status=done&width=200.5)刚刚的内部比较器写的<br />我们找下String类<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986634420-ced8db03-bb9a-4bee-a6a5-bf58d65c4141.png#align=left&display=inline&height=137&name=image.png&originHeight=274&originWidth=889&size=189333&status=done&width=444.5)<br />String类实现了comparable接口，具备了比较大小的能力<br />这个接口里有个方法叫做compareTo，实现了comparable接口中的方法<br />按照英文单词的升序去比的<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559986719583-204c0991-06f2-4ec0-98be-ae4960aaae82.png#align=left&display=inline&height=290&name=image.png&originHeight=580&originWidth=719&size=281207&status=done&width=359.5)<br />先求两个长度的最小值，然后取到最小值，如果小于这两个字符串中字数最少的那一个<br />开始根据索引把每一个索引取出，如果不相等，就返回这两个ascill码的差<br />相等的话k++继续去比<br />都比完了，得到的是这两个字符串长度的差<br />我们没有制定外部比较器，将给我们按照String的比较大小的升序去比较<br />如果不想这么比了，比方说想按照英文字母的个数去比，这个时候我们就需要外部比较器了<br />TreeMap有个构造方法<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559987120738-becfd3da-b61e-44a8-82eb-b6299b086517.png#align=left&display=inline&height=83&name=image.png&originHeight=166&originWidth=755&size=116876&status=done&width=377.5)其中的这个就是外部比较器<br />即传入一个比较器比较大小，那么怎么传入这给比较器？<br />我们写一个类<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559987326780-9ebc2b95-a243-4ad8-b1d0-46ef8a1cbfd4.png#align=left&display=inline&height=220&name=image.png&originHeight=440&originWidth=915&size=324102&status=done&width=457.5)<br />得到的结果就代表比较的三种情况，等于大于和小于<br />外部比较器创建完成了，那么如何使用呢？<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559987490532-12d20d97-8176-4b52-8f72-59018e389755.png#align=left&display=inline&height=115&name=image.png&originHeight=230&originWidth=754&size=190143&status=done&width=377)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559987510744-524b663b-8bb7-4ac0-9a07-fdb95936c285.png#align=left&display=inline&height=39&name=image.png&originHeight=77&originWidth=733&size=57555&status=done&width=366.5)<br />这时候就按照我们定义的进行比较了<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559987550434-c7da78cb-8d68-434e-ada9-8fd887ce0e55.png#align=left&display=inline&height=81&name=image.png&originHeight=161&originWidth=766&size=89193&status=done&width=383)





