# 34.ArrayList_JDK源码分析_1

<a name="NZWMB"></a>
## 导问
1. ArrayList的常用的构造方法有哪些？源码含义是什么？
  1. 分无参构造方法和带参构造方法，无参构造方法实际上是把一个长度为0的Object数组赋给了ArrayList对象，含参的实际上生成对应长度的数组再赋给对应对象
2. ArrayList扩容易原理是什么？
  1. 当发现需要扩容的时候就通过定义更大的数组，然后把旧数组的内容拷贝到新数组

主要分析三个方向<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559906496750-e04c9d2e-1e82-4955-8df9-c593c196e737.png#align=left&display=inline&height=163&name=image.png&originHeight=326&originWidth=747&size=80740&status=done&width=373.5)

源码分析<br />无参构造方法<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559906939320-89a08d46-3952-45c7-8686-e74f49d082d8.png#align=left&display=inline&height=75&name=image.png&originHeight=150&originWidth=596&size=77278&status=done&width=298)<br />无参构造方法的<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1559906681361-eacde9a6-199d-4139-a287-aa4f844f9aa8.png#align=left&display=inline&height=90&originHeight=180&originWidth=1057&status=done&width=528)<br />左侧elementData是一个Object类型的数组<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559906569547-4624af32-d474-466d-9113-44918c0cf5a6.png#align=left&display=inline&height=101&name=image.png&originHeight=202&originWidth=979&size=156312&status=done&width=489.5)<br />右侧，写着sf，说明是个静态常量<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559906730242-d53c797c-da3a-4291-bae1-cd971a611fbc.png#align=left&display=inline&height=29&name=image.png&originHeight=58&originWidth=1039&size=59936&status=done&width=519.5)<br />也就是它创建了一个长度为0的object数组<br />赋值的时候把这个长度为0的数组赋值给了elementDate<br />这时候开了空间，只是说长度为0<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559907340153-de2d4322-e5cc-4635-8ddb-85c819749d5c.png#align=left&display=inline&height=118&name=image.png&originHeight=235&originWidth=933&size=210429&status=done&width=466.5)

带参构造方法<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559908138965-1bae22b6-bfbc-43d5-bc86-31b1ea11a67d.png#align=left&display=inline&height=43&name=image.png&originHeight=85&originWidth=641&size=56725&status=done&width=320.5)<br />这时候调用的是<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559908280464-68f505fd-9321-44d0-92ac-2c05ba951ad6.png#align=left&display=inline&height=149&name=image.png&originHeight=297&originWidth=989&size=233083&status=done&width=494.5)<br />创建了长度为20的数组<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559908357582-92bbbd51-6585-450b-8074-337613829813.png#align=left&display=inline&height=24&name=image.png&originHeight=47&originWidth=855&size=50165&status=done&width=427.5)<br />如果说长度为0，那么执行这个，空数组，长度为0<br />如果是负数就抛出异常，保持程序健壮性<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559908959679-81f40a29-2f85-4d33-9b82-75b92795a89a.png#align=left&display=inline&height=119&name=image.png&originHeight=238&originWidth=876&size=141367&status=done&width=438)


add分析<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559908985064-dddfd7d7-2056-4e1a-b5e2-467ef88c3130.png#align=left&display=inline&height=50&name=image.png&originHeight=99&originWidth=675&size=90484&status=done&width=337.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559909000813-28227a49-747b-44d7-837a-c008a316fcf2.png#align=left&display=inline&height=87&name=image.png&originHeight=174&originWidth=1003&size=110357&status=done&width=501.5)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559909035674-b7b9308f-f6f3-4c95-8f33-b1082bf57fc6.png#align=left&display=inline&height=100&name=image.png&originHeight=199&originWidth=1032&size=88931&status=done&width=516)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559909055974-17dac616-de6a-4e42-b00b-a07e4d5cd6b1.png#align=left&display=inline&height=16&name=image.png&originHeight=31&originWidth=579&size=30167&status=done&width=289.5)<br />检测我们的容量是否能用，如果容量够用，添加没有问题，如果容量不够用就扩容<br />size是集合中元素的个数（先赋进来再进行++）<br />添加成功后返回true<br />0+1是所需的最小空间<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559909222064-669fdc97-7f9f-4e30-9518-41c60ca4f051.png#align=left&display=inline&height=51&name=image.png&originHeight=102&originWidth=1059&size=110999&status=done&width=529.5)<br />最少需要1个空间<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559909303324-ba20cc0a-0d91-41a5-b2b0-777dc8a4f319.png#align=left&display=inline&height=43&name=image.png&originHeight=85&originWidth=1026&size=134667&status=done&width=513)<br />计算容量<br />传进来的是object的一个数组，还有最小容量（1），如果数组果真是一个长度都没有<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559909424718-9e0ffaa1-16ba-4ecd-b2e0-c5527fc0b894.png#align=left&display=inline&height=62&name=image.png&originHeight=124&originWidth=1098&size=117773&status=done&width=549)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559909593015-e0d60404-83a4-4709-9207-29b589c3ec38.png#align=left&display=inline&height=234&name=image.png&originHeight=467&originWidth=1184&size=400294&status=done&width=592)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559909639622-0091a99d-c9c8-468b-98f8-d08a44525bc5.png#align=left&display=inline&height=166&name=image.png&originHeight=331&originWidth=1062&size=221322&status=done&width=531)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1559909766946-de15aa15-4493-43c9-ad52-0a317e7e4c8d.png#align=left&display=inline&height=195&name=image.png&originHeight=390&originWidth=1234&size=304128&status=done&width=617)<br />如果长度超过生成的值，就进行判断扩容（当前值加上右移一位的值即新生成的数组的值）
