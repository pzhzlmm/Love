# 82.UDP 协议数据传递细节

<a name="PcgDJ"></a>
## 导问
1. 简述UDP协议的特点？<br />
  1. 面向无连接的 不可靠 传输层协议 传输过程易丢包
2. 请你举例生活中的哪些应用使用到了UDP？
  1. 打电话,发电报

UDP 面向无连接的 不可靠 传输层协议 传输过程易丢包<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560220590479-0661a316-51eb-4e62-898d-4b5033fb104d.png#align=left&display=inline&height=192&name=image.png&originHeight=384&originWidth=749&size=215193&status=done&width=374.5)<br />不分服务器端和服务器端,只分发送方和接收方,UDP编写的程序是地位平等的<br />网站的一些聊天软件,就是用UDP完成的

![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560220728990-debf181b-a776-4a09-99a0-05999436618e.png#align=left&display=inline&height=312&name=image.png&originHeight=624&originWidth=854&size=211755&status=done&width=427)<br />接收方和发送方只是一个相对的概念<br />在UDP编程中,发送方和接收方统一使用![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560220796526-9a7abfc8-f9c2-4c7e-baae-58a62d5df8c6.png#align=left&display=inline&height=29&name=image.png&originHeight=57&originWidth=198&size=12027&status=done&width=99)<br />发送方可无需指定端口,系统会默认分配一个端口,接收方需要指定端口<br />这个端口值的是我本机的应用程序的端口<br />在网络中传输数据,传输的是一个数据包![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560221009562-9ea6e178-b972-419c-ab43-7a04a338a228.png#align=left&display=inline&height=28&name=image.png&originHeight=55&originWidth=224&size=17442&status=done&width=112)<br />发送方要在其中指定发送什么数据,发送多少,发到哪里去,发到哪里去的端口<br />接收方也是![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560221118004-30334aaa-9d72-4a05-b395-62617a7fa9a3.png#align=left&display=inline&height=22&name=image.png&originHeight=43&originWidth=224&size=13808&status=done&width=112)<br />要知道接收到的数据存放到哪里,一个byte类型的数组,接收数据的长度(数组的长度)<br />拿到数据之后要对数据进行拆包<br />有个getData方法,用于接收到真实的数据<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560221216486-c72925dd-f1ba-4d10-b73a-dbe4facee940.png#align=left&display=inline&height=60&name=image.png&originHeight=120&originWidth=241&size=41674&status=done&width=120.5)<br />用UDP编程的时候在网络中传输的是字节,所以就需要将各种数据转成byte类型的bytearrayinputstream和bytearrayoutstream字节数组流<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560221339915-621aa0ae-08e3-4958-b924-09786f2e08d7.png#align=left&display=inline&height=301&name=image.png&originHeight=601&originWidth=1519&size=372340&status=done&width=759.5)<br />接收方接收到数据之后要给发送方回复数据![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560221382071-1ed1376c-8f5b-40aa-bc5c-d7def6d1a526.png#align=left&display=inline&height=25&name=image.png&originHeight=50&originWidth=275&size=21061&status=done&width=137.5)<br />B就要准备![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560221441879-dfcd3798-6a96-4ac1-a643-d04cf4ef5525.png#align=left&display=inline&height=47&name=image.png&originHeight=93&originWidth=256&size=35479&status=done&width=128)<br />接收的数据包和发送的数据包并不是同一个<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560221555600-c3646452-88ff-4594-82f1-b7f7255948ab.png#align=left&display=inline&height=529&name=image.png&originHeight=1058&originWidth=2439&size=1250126&status=done&width=1219.5)<br />整个数据就是对数据进行打包,即把我们发送的数据转成byte类型,接收方接收到的数据再转成真实类型
