# 120.反射创建Servlet对象


![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406451541-3355e00a-6a66-4b8f-a580-5474ffef02c8.png#align=left&display=inline&height=56&name=image.png&originHeight=113&originWidth=746&size=58032&status=done&width=373)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406108838-5c4811cb-302c-41b9-a75b-5adbfbedf24b.png#align=left&display=inline&height=163&name=image.png&originHeight=325&originWidth=929&size=149466&status=done&width=464.5)<br />采用键值对<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406157999-aaa2f581-b7db-4c0a-ba16-255b14b14abc.png#align=left&display=inline&height=142&name=image.png&originHeight=283&originWidth=1006&size=201409&status=done&width=503)<br />name键 class 值<br />就是一个都是string类型的map集合<br />servlet<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406236492-283cd068-0c0d-4965-b00b-e7f725c6826d.png#align=left&display=inline&height=27&name=image.png&originHeight=54&originWidth=1591&size=138478&status=done&width=795.5)<br />mapping<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406361055-cd449035-5363-4182-9574-d311ad521dc4.png#align=left&display=inline&height=23&name=image.png&originHeight=46&originWidth=1994&size=163150&status=done&width=997)<br />编写成私有属性<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406385760-b6921be7-272f-4f87-96b5-dc191dd881b7.png#align=left&display=inline&height=357&name=image.png&originHeight=713&originWidth=1280&size=538222&status=done&width=640)<br />公有取值赋值方法<br />构造函数<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406436378-145b156f-9758-4e40-a469-803c26015e01.png#align=left&display=inline&height=58&name=image.png&originHeight=116&originWidth=680&size=92781&status=done&width=340)


![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406459371-4e45cbcc-d301-4445-b030-df6ce255b114.png#align=left&display=inline&height=100&name=image.png&originHeight=199&originWidth=616&size=77588&status=done&width=308)<br />通过static静态代码块来进行初始化<br />首先初始化上下文容器,容器中里面包含了两个map集合,一个是关于servlet类的,一个是关于mapping的<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406711610-a2421e27-6819-4e61-8cf5-374fc3997c45.png#align=left&display=inline&height=291&name=image.png&originHeight=581&originWidth=981&size=423234&status=done&width=490.5)

![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406824651-bbac5c9c-6720-4936-b4b2-b1830f28989f.png#align=left&display=inline&height=52&name=image.png&originHeight=103&originWidth=727&size=101937&status=done&width=363.5)<br />要把获取的存储进去,因此就要进行遍历<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406961359-33c605dc-d099-4849-8935-3282d7e9d22a.png#align=left&display=inline&height=63&name=image.png&originHeight=126&originWidth=845&size=104068&status=done&width=422.5)<br />测试<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406973819-c44a0e31-d675-4d7e-a968-10e40d03623e.png#align=left&display=inline&height=169&name=image.png&originHeight=337&originWidth=1006&size=178698&status=done&width=503)<br />结果<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560406952558-d9566a3e-9ece-494d-8f3b-884768c12589.png#align=left&display=inline&height=38&name=image.png&originHeight=75&originWidth=1204&size=111264&status=done&width=602)<br />再遍历mapping<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407098974-9f57b858-719a-4168-be9c-66b04df802c9.png#align=left&display=inline&height=91&name=image.png&originHeight=182&originWidth=756&size=137615&status=done&width=378)<br />集合中每个元素都作为mapping集合里的键<br />测试<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407145567-12622bb3-83c2-401b-a25b-42f7cba99e74.png#align=left&display=inline&height=202&name=image.png&originHeight=403&originWidth=885&size=207621&status=done&width=442.5)<br />结果<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407114074-9babacf4-d61a-4345-b70d-ab62c1010846.png#align=left&display=inline&height=56&name=image.png&originHeight=111&originWidth=1177&size=128454&status=done&width=588.5)

由此,我们将两个数据储存到map集合里就都存储完毕了

下面就是根据url创建对应servlet对象<br />先判断下是否为空<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407258693-5229ea8e-5e15-4566-aed8-bd2d81ce454e.png#align=left&display=inline&height=142&name=image.png&originHeight=284&originWidth=831&size=129499&status=done&width=415.5)<br />根据url,获取servletname<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407305534-5d697b18-08af-4abd-b65b-28b25c052066.png#align=left&display=inline&height=50&name=image.png&originHeight=99&originWidth=186&size=28670&status=done&width=93)<br />这个集合就是上下文中的<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407377480-4542a56a-3c59-49ba-8e0f-f6bb93ef0fa2.png#align=left&display=inline&height=88&name=image.png&originHeight=175&originWidth=741&size=164865&status=done&width=370.5)<br />于是<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407430633-fb21a2b0-ef8b-455c-8a2e-c9c30251d445.png#align=left&display=inline&height=333&name=image.png&originHeight=665&originWidth=1098&size=437075&status=done&width=549)<br />接下来![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407478422-19d894f0-3d33-4b91-91e5-e188a501e7b4.png#align=left&display=inline&height=19&name=image.png&originHeight=38&originWidth=556&size=36694&status=done&width=278)<br />这个在这个集合中<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407501724-9c69b7fc-4423-4f71-8fd0-0542a46e6adc.png#align=left&display=inline&height=97&name=image.png&originHeight=194&originWidth=812&size=160734&status=done&width=406)<br />所以接下来这么写<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407570885-00b6b173-b125-44fa-b35a-59a20a07848a.png#align=left&display=inline&height=19&name=image.png&originHeight=38&originWidth=880&size=50771&status=done&width=440)<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407551653-b2ba9566-b375-4728-ae10-c1713eb96149.png#align=left&display=inline&height=34&name=image.png&originHeight=68&originWidth=662&size=58666&status=done&width=331)<br />再使用反射创建servlet对象<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407600781-ec6d96e7-5951-477c-a655-2a940ffed0b4.png#align=left&display=inline&height=34&name=image.png&originHeight=67&originWidth=655&size=58830&status=done&width=327.5)<br />再创建对象<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407626116-2676c59c-6094-4ef5-bea9-6684f91ec8ed.png#align=left&display=inline&height=30&name=image.png&originHeight=60&originWidth=561&size=55677&status=done&width=280.5)<br />这时候要求强制类型转换<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407649576-9f64286b-3e32-47c2-82ad-4869326cdbbe.png#align=left&display=inline&height=61&name=image.png&originHeight=122&originWidth=739&size=114828&status=done&width=369.5)<br />那么就转成servlet对象,最后返回<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407694011-df17f8d4-f36e-4134-afa7-4ec3822f6398.png#align=left&display=inline&height=34&name=image.png&originHeight=68&originWidth=702&size=61686&status=done&width=351)

完整逻辑<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407722304-45ad7d2f-36d1-47a2-a983-8bae911d5b10.png#align=left&display=inline&height=212&name=image.png&originHeight=424&originWidth=1013&size=402696&status=done&width=506.5)<br />ctrl+alt+z处理异常<br />出错直接return null

测试<br />![image.png](https://cdn.nlark.com/yuque/0/2019/png/349894/1560407854736-65a163b8-76b7-42a9-a9c7-a65653dbab47.png#align=left&display=inline&height=179&name=image.png&originHeight=357&originWidth=970&size=283911&status=done&width=485)<br />不同路径都创建了同一对象
