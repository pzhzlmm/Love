# 222.Log4J配置文件详解_日志格式简介_日志对象的获取及使用

<a name="37b49c7a"></a>
# log4j 的使用
<a name="17277b5e"></a>
## 导包
log4j-1.2.17.jar<br />log4j-api-2.0-rc1.jar<br />log4j-core-2.0-rc1.jar 核心

<a name="15c64aa0"></a>
## 配置文件
使用一个叫 log4j.properties 的配置文件, 会设定 log4j 的设置信息, 例如日志级别, 日志输出方式, 日志格式等等.<br />这个log文件不需要自己写,这里面key是固定的,就像userrname,password不能写别的词,这个log文件一般都有现成的<br />打开eclipse可以找到<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451242745-ef8a41e0-5aee-4ebf-b6cd-57a6af47de52.png#align=left&display=inline&height=398&originHeight=450&originWidth=940&status=done&width=831)<br />复制了之后直接放到src下面<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451242843-d9bd6105-b28e-477c-994c-d7d91f489313.png#align=left&display=inline&height=357&originHeight=238&originWidth=339&status=done&width=509)<br />打开之后查看,<br />这些先不要<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451242935-7fafc661-c965-4489-b809-eda89b72ffce.png#align=left&display=inline&height=350&originHeight=374&originWidth=888&status=done&width=831)<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243029-7c4acd3a-62ff-4879-a840-25e33c2e3c92.png#align=left&display=inline&height=182&originHeight=237&originWidth=1082&status=done&width=831)<br />接下来分析留下的<br /># Set root category priority to INFO and its only appender to CONSOLE.<br />log4j.rootCategory=DEBUG, CONSOLE//设置日志级别为info级别,同时只在控制台打印这些信息.如果要设置打印到文件里可设置为logfile<br /># log4j.rootCategory=DEBUG, CONSOLE, LOGFILE

//这些是控制台的输出格式的<br /># CONSOLE is set to be a ConsoleAppender using a PatternLayout.<br />log4j.appender.CONSOLE=org.apache.log4j.ConsoleAppender//定义好的工具类,会用这个工具类自动往控制台打印信息<br />log4j.appender.CONSOLE.layout=org.apache.log4j.PatternLayout//前两句话都是固定的,layout:布局,采用patternlayout的布局模式来打印<br />log4j.appender.CONSOLE.layout.ConversionPattern=- %m %c %l<br />%d{yyyy-MM-dd HH:mm:ss}%n<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243107-406c0d4d-aca2-433c-b1e7-6bf3d9eb4fba.png#align=left&display=inline&height=140&originHeight=166&originWidth=988&status=done&width=831)<br />除了这些格式还有这种格式<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243194-adefa2a2-ab1a-4e8d-ba46-8cf73a8a2af3.png#align=left&display=inline&height=69&originHeight=46&originWidth=328&status=done&width=492)

//打印到文件的输出格式<br /># LOGFILE is set to be a File appender using a PatternLayout.<br />log4j.appender.LOGFILE=org.apache.log4j.FileAppender//打印的类<br />log4j.appender.LOGFILE.File=d:/test.log//存在什么位置<br />log4j.appender.LOGFILE.Append=true//如果设置成true,那么所有的日志文件都存储在这里面追加,如果设置成false,就进行覆盖<br />log4j.appender.LOGFILE.layout=org.apache.log4j.PatternLayout<br />log4j.appender.LOGFILE.layout.ConversionPattern=- %m %l%n//格式<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243270-5ecd6a53-86f8-432f-af6c-7f6a29c9814d.png#align=left&display=inline&height=1252&originHeight=1241&originWidth=824&status=done&width=831)
<a name="1c91addf"></a>
## 1.4 测试
package com.bjsxt.test;<br />import org.apache.log4j.Logger;<br />public class TestLog4j {<br />public static void main(String[] args) {<br />// 获取日志对象(Logger这个类里提供了一个静态方法),里面需要传一个类,即在哪个类里面传哪个就可以了,目的是要获取当前类里的日志对象<br />//拿到class的方法有很多,如果有对象,对象.getclass,如果有类,就类.class,如果连class都拿不到,那就classforname<br />Logger logger = Logger.getLogger(TestLog4j.class);<br />// 五个日志级别分别对应五个输出方法, 方法名和级别名一致<br />logger.fatal("系统崩溃了...");//里面是message信息,即想输出什么就输出什么 <br />logger.error("发生了错误!");<br />logger.warn("警告!");<br />logger.info("消息~");<br />logger.debug("调试...");<br />}<br />}<br />输出:<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243351-c6b5c055-cfc4-461d-8f85-a1c03fa67015.png#align=left&display=inline&height=249&originHeight=166&originWidth=204&status=done&width=306)<br />之所以有横杠是因为我们设置的:<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243424-e5cd2067-21df-4e81-93c9-31e3bca19e5c.png#align=left&display=inline&height=171&originHeight=114&originWidth=504&status=done&width=756)<br />此时我们把输出级别换成error<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243509-9a41f493-b455-486f-846b-7daf74e0e470.png#align=left&display=inline&height=117&originHeight=106&originWidth=755&status=done&width=831)<br />现在只会输出error及其以上的了<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243579-3f7c4779-3bfe-40e4-b9e7-5a2239e2fc0a.png#align=left&display=inline&height=230&originHeight=153&originWidth=315&status=done&width=473)<br />级别设置成debug(最低)格式加个%c(这里大小写一样),就能获取到当前在哪个类发生的错误<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243645-38760460-567f-4328-ba47-6df21851c91e.png#align=left&display=inline&height=239&originHeight=293&originWidth=1020&status=done&width=831)<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243727-2e2cd1e0-509d-4fad-b9e5-62fd96c34b78.png#align=left&display=inline&height=277&originHeight=225&originWidth=674&status=done&width=831)

再加个%l<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243799-7547e95b-76e6-45ee-af6d-e271940124f0.png#align=left&display=inline&height=26&originHeight=30&originWidth=950&status=done&width=831)<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243886-0e8e8e56-ed2b-40c0-b28b-63366b546227.png#alt=&height=155&originHeight=224&originWidth=1203&width=831)<br />包名+类名+方法名,行数也显示出来了

再加个%d<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451243991-598e4b1d-e2a9-4268-b608-4e964483faf6.png#alt=&height=26&originHeight=58&originWidth=1883&width=831)<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451244069-2ba86f47-7291-481b-9a27-d62b49324819.png#alt=&height=143&originHeight=216&originWidth=1258&width=831)<br />时间就给出来了

因此通过简单地修改配置文件,想设置成什么样就设置成什么样<br />更多的可以去网上搜寻<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451244148-c0f27e28-94b9-4485-959b-9d38f53ea1d8.png#alt=&height=561&originHeight=655&originWidth=969&width=831)

除了打印到控制台,还可以打印到日志文件<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451244332-fb44adf5-8f4c-4034-b519-ff79135b4508.png#alt=&height=161&originHeight=139&originWidth=718&width=831)

![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451244440-dc10070b-b0ff-473d-91bb-3cfa9e01f8b9.png#alt=&height=621&originHeight=414&originWidth=415&width=623)<br />![](https://cdn.nlark.com/yuque/0/2019/png/349894/1561451244538-fbbba1ea-ec2d-4a0e-a39b-b574e7f6949c.png#alt=&height=347&originHeight=291&originWidth=697&width=831)

