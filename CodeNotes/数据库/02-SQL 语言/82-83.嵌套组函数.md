# 82/83.嵌套组函数

<a name="RKyO2"></a>
# 组函数小节练习
4.1组函数在多行上计算，对每个组产生一个结果。True/False<br />答案：True<br />4.2组函数在计算中包含空值。True/False<br />答案：False(无论组函数还是单行函数遇到空值都会忽略不计)<br />组函数会忽略空值，如果需要空值参与计算，需要使用 nvl 函数处理空值。<br />4.3在分组计算中，WHERE 子句对行的限制在计算的前面。<br />True/False<br />答案：True<br />4.4显示所有雇员的最高、最低、合计和平均薪水，列标签分别为：<br />Maximum、Minimum、Sum 和 Average。四舍五入结果<br />为最近的整数。<br />答案：<br />select<br />max(salary),min(salary),sum(salary),avg(sal<br />ary) from employees;<br />4.5修改上题显示每中工作类型的最低、最高、合计和平均薪水。<br />答案：<br />select<br />max(salary),min(salary),sum(salary),avg(sal<br />ary) from employees group by job_id;<br />4.6写一个查询显示每一工作岗位的人数。<br />答案：<br />select job_id, count(*) from employees<br />group by job_id;<br />4.7确定经理人数，不需要列出他们，列标签是 Number of<br />Managers。<br />答案：<br />select count(distinct manager_id) from<br />employees ;<br />4.8写一个查询 显示最高和最低薪 水之间的差。列标签 是<br />DIFFERENCE。<br />答案：<br />select max(salary) - min(salary) from<br />employees;<br />4.9显示经理号和经理付给雇员的最低薪水。排除那些经理未知的<br />人。排除最低薪水小于等于 $6,000 的组(这种查询时就做好的判断就放where里去做)。按薪水降序排序<br />输出。<br />答案：<br />select e.manager_id ,min(e.salary) from<br />employees e where e.manager_id is not null<br />group by e.manager_id having min(e.salary) ><br />6000 order by min(e.salary) desc;<br />4.10写一个查询显示每个部门的名字、地点、人数和部门中所有<br />雇员的平均薪水。四舍五入薪水到两位小数。<br />答案：<br />select<br />d.department_name,d.location_id,count(*) ,a<br />vg(e.salary) from employees e ,departments d<br />where e.department_id = d.department_id group<br />by d.department_name ,d.location_id;<br />4.11创建一个查询显示雇员总数，和在 2001、2002、2003 和<br />受雇的雇员人数。创建适当的列标题。<br />答案：<br />select count(*)<br />total,sum(decode(to_char(hire_date,<br />'yyyy'),<br />'2000'<br />,1,0))"2000" ,sum(decode(to_char(hire<br />_date,<br />'yyyy'),<br />'2001'<br />,1,0))"2001",sum(decode<br />(to_char(hire_date,<br />'yyyy'),<br />'2002'<br />,1,0))"200<br />2",sum(decode(to_char(hire_date,<br />'yyyy'),<br />'20<br />03'<br />,1,0))"2003" from employees e;<br />4.12创建一个混合查询显示工作岗位和工作岗位的薪水合计，并<br />且合计部门 20、50、80 和 90 的工作岗位的薪水。给每<br />列一个恰当的列标题。<br />答案：<br />select<br />job_id,sum(salary),sum(decode(department_id,<br />20,salary))"Dep<br />20",sum(decode(department_id,50,salary))"De<br />p<br />50",sum(decode(department_id,80,salary))"De<br />p<br />80" ,sum(decode(department_id,90,salary))"D<br />ep 90"from employees group by job_id;
