# 91/92.子查询小节练习

4 子查询小结练习<br />4.1写一个查询显示与 Zlotkey 在同一部门的雇员的 last name<br />和 hire date，结果中不包括 Zlotkey。<br />答案：<br />select em.last_name,em.hire_date from<br />employees em where em.department_id = (select<br />e.department_id from employees e where<br />e.last_name = 'Zlotkey');<br />4.2创建一个查询显示所有其薪水高于平均薪水的雇员的雇员号<br />和名字。按薪水的升序排序。<br />答案：<br />select em.employee_id,em.last_name from<br />employees em where em.salary > (select<br />avg(salary) from employees) order by<br />em.salary;<br />4.3写一个查询显示所有工作在有任一雇员的名字中包含一个 u<br />的部门的雇员的雇员号和名字。<br />答案：<br />select e.employee_id,e.last_name from<br />employees e where e.department_id in(select<br />em.department_id from employees em where<br />em.last_name like '%u%');<br />4.4显示所有部门地点号 (department location ID ) 是 1700<br />的雇员的 last name、department number 和 job ID。<br />答案：<br />select<br />em.last_name,em.department_id,em.job_id<br />from employees em where em.department_id<br />in(select d.department_id from departments d<br />where d.location_id = 1700);<br />4.5显示每个向 King 报告的雇员的名字和薪水。<br />答案：<br />select e.last_name,e.salary from<br />employees e where e.manager_id in(select<br />em.employee_id from employees em where<br />em.last_name = 'King');<br />4.6显 示 在 Executive 部 门 的 每 个 雇 员 的 department<br />number、last name 和 job ID。<br />答案：<br />select<br />em.department_id,em.last_name,em.job_id<br />from employees em where em.department_id =<br />(select d.department_id from departments d<br />where d.department_name ='Executive');<br />4.7查询显示所有收入高于平均薪水并且工作在有任一雇员的名<br />字中带有一个 u 的部门的雇员的 employee numbers、last<br />names 和 salaries。<br />答案：<br />select<br />emp.employee_id,emp.last_name,emp.salary<br />from employees emp where emp.salary > (select<br />avg(salary) from employees) and<br />emp.department_id in(select em.department_id<br />from employees em where em.last_name like<br />'%u%');
