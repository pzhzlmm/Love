<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Customize Toolbar</title>
    <style type="text/css">
        html { overflow-x: hidden; overflow-y: auto; } 
        body
        {
            font-family: "Microsoft YaHei", Georgia, Helvetica, Arial, sans-serif, 宋体, serif, PMingLiU;
            color: black;
            background-color: #fff;
            font-size: 10.5pt;
            margin: 1em;
            padding: 1em;
            line-height: 1.5;
        }
        div
        {
            font-size: 1em;
        }
        table
        {
            empty-cells: show;
            margin: 0;
            padding: 0;
        }
        font
        {
            font-size: 1em;
        }
        ul
        {
            padding: 0 0 1em 1em;
        }
        ol
        {
            padding: 0 0 1em 1.3em;
        }
        li
        {
            line-height: 1.5em;
            padding: 0 0 0 0;
        }
        p
        {
            padding: 0;
        }
        h1, h2, h3, h4, h5
        {
            padding: 0;
        }
        h1
        {
            font-size: 1.3em; /*1.3em*/
        }
        h2
        {
            font-size: 1.1em; /*1.3em*/
        }
        h3
        {
            font-size: 1em; /*1.1em;*/ ;line-height:1.4em;white-space:nowrap;padding:0;}
        h4, h5, table
        {
            font-size: 1em;
        }
        sup, sub
        {
            font-size: .7em;
        }
        input, select, textarea, option
        {
            font-family: inherit;
            font-size: inherit;
        }
        input[type='checkbox']
	{
            width: 12px;
            height: 12px;
	}
        img
        {
            border-style: none;
        }
        a
        {
            outline: none;
            color: #00c;
        }
        a:active
        {
            color: red;
        }
        a:visited
        {
            color: #551a8b;
        }
        hr
        {
            border: 0;
            background-color: #EEE;
            border-bottom: #c9d7f1 1px solid;
            height: 0px;
            width: 99.9%;
            text-align: left;
            margin-top: 1em;
            margin-bottom: 1em;
        }
        div.my_group
        {
            padding-top:10px;
            padding-bottom:10px;
            font-weight:bold;
        }
    </style>

</head>
<body>
    <fieldset>
        <legend><b><span id="labelButtons">Buttons</span></b></legend>
        <table border="0">
            <tr>
                <td>
                    <input id="StickyNote" type="checkbox" /><label id="labelStickyNote" for="StickyNote">Sticky note</label>
                </td>
            </tr>
            <tr>
                <td>
                    <input id="TodoList" type="checkbox" /><label id="labelTodoList" for="TodoList">Todo list</label>
                </td>
            </tr>
            <tr>
                <td>
                    <input id="ReminderList" type="checkbox" /><label id="labelReminder" for="ReminderList">Reminder list</label>
                </td>
            </tr>
            <tr>
                <td>
                    <input id="NewDocumentFromTemplate" type="checkbox" /><label id="labelNewDocumentFromTemplate"
                        for="NewDocumentFromTemplate">New document from template</label>
                </td>
            </tr>
            <tr>
                <td>
                    <input id="FullScreen" type="checkbox" /><label id="labelFullScreen" for="FullScreen">Fullscreen</label>
                </td>
            </tr>
            <tr>
                <td>
                    <input id="AppCenter" type="checkbox" /><label id="labelAppCenter" for="AppCenter">App</label>
                </td>
            </tr>
            <tr>
                <td>
                    <input id="Calendar" type="checkbox" /><label id="labelCalendar" for="Calendar">Calendar</label>
                </td>
            </tr>
            
            <tr>
                <td>
                    <input id="Homepage" type="checkbox" /><label id="labelHomepage" for="Homepage">Homepage</label>
                </td>
            </tr>
            <tr>
                <td>
                    <input id="Options" type="checkbox" /><label id="labelOptions" for="Options">Options</label>
                </td>
            </tr>
            <tr>
                <td>
                    <input id="Invite" type="checkbox" /><label id="labelInvite" for="Invite">Invite friends</label>
                </td>
            </tr>
        </table>
    </fieldset>
    <p align="right">
        <input id="buttonRestoreDefaults" onclick="RestoreDefaults();" style="width: 150px;"
            type="button" value="Restore Defaults" />&nbsp;
        <input id="buttonOK" onclick="CloseDialog(1);" style="width: 70px;"
            type="button" value="OK" />&nbsp;
        <input id="buttonCancel" onclick="CloseDialog(2);" style="width: 70px;"
            type="button" value="Cancel" />
    </p>


    <script language="JavaScript">
        function getBool(section, key, def) {
            if (section == null)
                return def;
            val = section.GetStringValue(key);
            if (val == null || val == "")
                return def;
            return val == "1";
        }
        //
        function initButton(section, button, def) {
            if (button.type.toLowerCase() != "checkbox")
                return;
            if (button.id == null || button.id == "")
                return;
            var b = getBool(section, button.id, def);
            button.checked = b;
        }

        var objApp = window.external;
        var objSettings = objApp.CreateWizObject("WizKMCore.WizSettings");
        objSettings.Open(objApp.SettingsFileName);
        //
        var sectionName = "Explorer_Toolbar";
        var section = objSettings.Section(sectionName);
        //
        initButton(section, StickyNote, false);
        initButton(section, ReminderList, true);
        initButton(section, NewDocumentFromTemplate, false);
        initButton(section, FullScreen, true);
        initButton(section, AppCenter, true);
        initButton(section, TodoList, false);
        initButton(section, Calendar, false);
        initButton(section, Homepage, false);
        initButton(section, Options, false);
        initButton(section, Invite, false);
        //
        function saveButton(button, def) {
            objSettings.SetBoolValue(sectionName, button.id, button.checked);
        }

        function CloseDialog(ret) {
            if (ret == 1) {
                //
                saveButton(StickyNote);
                saveButton(ReminderList);
                saveButton(NewDocumentFromTemplate);
                saveButton(FullScreen);
                saveButton(AppCenter);
                saveButton(TodoList);
                saveButton(Calendar);
                saveButton(Homepage);
                saveButton(Options);
                saveButton(Invite);
                //
                objSettings.Close();
                //
                objApp.ExecuteCommand("ResetToolBar", "", "");
            }
            objApp.Window.CloseHtmlDialog(WizChromeBrowser, ret);
        }

        function RestoreDefaults() {
            StickyNote.checked = false;
            ReminderList.checked = true;
            NewDocumentFromTemplate.checked = false;
            FullScreen.checked = true;
            AppCenter.checked = true;
            TodoList.checked = false;
            Calendar.checked = false;
            Homepage.checked = false;
            Options.checked = false;
            Invite.checked = false;
        }
        //
        objApp.PluginLocalizeHtmlDialog(WizChromeBrowser);

    </script>

</body>
</html>
